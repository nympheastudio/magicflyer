(function(a){a.widget("ui.tagify",{options:{delimiters:[13,188,44],outputDelimiter:",",cssClass:"tagify-container",addTagPrompt:"add tags",addTagOnBlur:false},_create:function(){var c=this,d=c.element,e=c.options;this.tags=[];this.tagInput=a("<input type='text'>").attr("placeholder",e.addTagPrompt).keypress(function(j){var h=a(this),g=j.which;for(i in e.delimiters){if(g==e.delimiters[i]){c.add(h.val());j.preventDefault();return false}}}).keydown(function(g){c.keyDownValue=a(this).val()}).keyup(function(j){var h=a(this),g=j.which;if(g==8){if(c.keyDownValue==""){c.remove();return false}return}});if(e.addTagOnBlur){this.tagInput.blur(function(h){var g=a(this);if(""!==g.val()){c.add(g.val());h.preventDefault();return false}})}this.tagDiv=a("<div></div>").addClass(e.cssClass).click(function(){a(this).children("input").focus()}).append(this.tagInput).insertAfter(d.hide());var b=a.trim(d.val());if(b){var f=b.split(e.outputDelimiter);a.each(f,function(h,g){c.add(g)})}},_setOption:function(b,c){options.key=c},add:function(f){var b=this;f=f||b.tagInput.val();if(f){var e=b.tags.length;var d=a("<a href='#'>x</a>").click(function(){b.remove(e);return false});var c=a("<span></span>").text(f).append(d);b.tagInput.before(c);b.tags.push(f);b.tagInput.val("")}},remove:function(c){var b=this;if(c==null||c===(b.tags.length-1)){this.tagDiv.children("span").last().remove();b.tags.pop()}if(typeof(c)=="number"){this.tagDiv.children("span:eq("+c+")").hide();delete (b.tags[c])}},serialize:function(){var c=this;var g=c.options.outputDelimiter;var d=c.tags.join(g);var f=new RegExp(g+g+"+","g");var b=new RegExp("^"+g+"|"+g+"$","g");var e=d.replace(f,g).replace(b,"");c.element.val(e);return e},inputField:function(){return this.tagInput},containerDiv:function(){return this.tagDiv},destroy:function(){a.Widget.prototype.destroy.apply(this);this.tagDiv.remove();this.element.show()}})})(jQuery);